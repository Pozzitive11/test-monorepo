<div class="container">
  <header class="">
    <app-header-open-court></app-header-open-court>
  </header>
  <div class="nav-switches">
    <ul class="nav nav-tabs">
      <li class="nav-item" (click)="switchToMainTab()" [ngClass]="{ 'selected-tab': activeTab === 'main' }">
        <a class="nav-link" [ngClass]="{ 'active': activeTab === 'main' }">
          <svg width="22" height="23" viewBox="0 0 22 23" fill="none" style="margin-right: 5px;" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_2_475)">
              <path d="M2.94315 4.28966H19.0346M10.9921 4.28966V18.6111M6.00244 21.3467H15.9792L14.2091 18.933H7.61159L6.00244 21.3467ZM12.5011 2.37537C12.5011 3.21964 11.8167 3.90406 10.9724 3.90406C10.1281 3.90406 9.44371 3.21964 9.44371 2.37537C9.44371 1.5311 10.1281 0.84668 10.9724 0.84668C11.8167 0.84668 12.5011 1.5311 12.5011 2.37537ZM6.91971 11.1929C6.91971 12.625 5.76113 13.7997 4.31289 13.7997C2.86466 13.7997 1.72217 12.625 1.72217 11.1929L4.32899 4.28966L6.91971 11.1929ZM20.278 11.1929C20.278 12.625 19.1194 13.7997 17.6712 13.7997C16.2229 13.7997 15.0643 12.6411 15.0643 11.1929L17.6712 4.28966L20.278 11.1929Z" stroke="white" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" />
            </g>
            <defs>
              <clipPath id="clip0_2_475">
                <rect width="22" height="22" fill="white" transform="translate(0 0.0966797)" />
              </clipPath>
            </defs>
          </svg>
          Судові справи
        </a>
      </li>
      <li class="nav-item" (click)="switchToInstancesTab()" [ngClass]="{ 'selected-tab': activeTab === 'instances' }">
        <a class="nav-link" [ngClass]="{ 'active': activeTab === 'instances' }">
          <svg width="23" height="23" viewBox="0 0 23 23" fill="none" style="margin-right: 5px;" xmlns="http://www.w3.org/2000/svg">
            <g clip-path="url(#clip0_2_470)">
              <path d="M16.338 9.31905V18.831M13.222 9.31905V18.831M9.778 18.831V9.31905M3.71 18.831V9.31905M6.662 9.31905V18.831M19.29 9.31905V18.831M1.25 6.36705L11.5 0.873047L21.75 6.36705V8.99105H1.25V6.36705ZM21.75 20.061V21.291H1.25V20.061C1.25 19.405 1.824 18.831 2.48 18.831H20.52C21.176 18.831 21.75 19.405 21.75 20.061Z" stroke="#171717" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" />
            </g>
            <defs>
              <clipPath id="clip0_2_470">
                <rect width="22" height="22" fill="white" transform="translate(0.5 0.0820312)" />
              </clipPath>
            </defs>
          </svg>
          Виконавчі провадження
        </a>
        <div class="active-tab-line"></div>
      </li>
    </ul>
  </div>
  <div class="filter-container">
    <div *ngIf="activeTab === 'main'">
      <app-open-court-filters (searchCompleted)="updateCourtDataList($event)"></app-open-court-filters>
    </div>
  </div>

  <ngx-spinner bdColor="rgba(0, 0, 0, 0.8)" size="medium" color="#0d6efd" type="ball-clip-rotate-multiple" [fullScreen]="true">
    <p style="color: #0d6efd"><strong>Обробка...</strong></p>
  </ngx-spinner>

  <div class="card-container">
    <div *ngIf="courtDataList.length > 0" class="view-switcher-container d-flex flex-wrap align-items-center">
      <div class="sort-container">
        <div class="view-switcher d-flex align-items-center mb-2 mb-md-0">
          <span (click)="switchView('cards')" [class.active]="currentView === 'cards'" class="me-2">
            <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
              <rect x="0.5" y="0.078125" width="3" height="16" rx="1.5" fill="#171717" />
              <rect x="6.5" y="0.078125" width="3" height="16" rx="1.5" fill="#171717" />
              <rect x="12.5" y="0.078125" width="3" height="16" rx="1.5" fill="#171717" />
            </svg>
          </span>
          <span (click)="switchView('list')" [class.active]="currentView === 'list'" class="me-3">
            <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
              <g clip-path="url(#clip0_2_835)">
                <path d="M6.5 15.5781C5.67157 15.5781 5 14.9066 5 14.0781C5 13.2497 5.67157 12.5781 6.5 12.5781H14.5C15.3284 12.5781 16 13.2497 16 14.0781C16 14.9066 15.3284 15.5781 14.5 15.5781H6.5Z" fill="#171717" fill-opacity="0.4" />
                <path d="M1.5 15.5781C0.671573 15.5781 8.39111e-08 14.9066 4.76994e-08 14.0781C1.14877e-08 13.2497 0.671573 12.5781 1.5 12.5781C2.32843 12.5781 3 13.2497 3 14.0781C3 14.9066 2.32843 15.5781 1.5 15.5781Z" fill="#171717" fill-opacity="0.4" />
                <path d="M6.5 9.57812C5.67157 9.57812 5 8.90655 5 8.07813C5 7.2497 5.67157 6.57813 6.5 6.57813L14.5 6.57812C15.3284 6.57812 16 7.2497 16 8.07812C16 8.90655 15.3284 9.57812 14.5 9.57812H6.5Z" fill="#171717" fill-opacity="0.4" />
                <path d="M1.5 9.57813C0.671573 9.57813 2.9848e-07 8.90655 2.62268e-07 8.07813C2.26057e-07 7.2497 0.671573 6.57813 1.5 6.57813C2.32843 6.57813 3 7.2497 3 8.07813C3 8.90655 2.32843 9.57813 1.5 9.57813Z" fill="#171717" fill-opacity="0.4" />
                <path d="M6.5 3.57813C5.67157 3.57813 5 2.90655 5 2.07813C5 1.2497 5.67157 0.578125 6.5 0.578125L14.5 0.578125C15.3284 0.578125 16 1.2497 16 2.07812C16 2.90655 15.3284 3.57812 14.5 3.57812L6.5 3.57813Z" fill="#171717" fill-opacity="0.4" />
                <path d="M1.5 3.57813C0.671573 3.57813 3.62117e-08 2.90655 0 2.07813C-3.62117e-08 1.2497 0.671573 0.578126 1.5 0.578126C2.32843 0.578126 3 1.2497 3 2.07813C3 2.90655 2.32843 3.57813 1.5 3.57813Z" fill="#171717" fill-opacity="0.4" />
              </g>
              <defs>
                <clipPath id="clip0_2_835">
                  <rect width="16" height="16" fill="white" transform="translate(0 16.0781) rotate(-90)" />
                </clipPath>
              </defs>
            </svg>
          </span>
        </div>
        <div class="d-flex align-items-center mb-2 mb-md-0">
          <div class="custom-dropdownss me-2">
            <button class="custom-dropdownss dropdown-toggless" type="button" id="sortByDropdown" (click)="toggleDropdown('sortfilters')" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <svg width="16" height="17" viewBox="0 0 16 17" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M7.53755 12.6135L5.19659 15.0623L5.15038 15.1085C5.05798 15.2163 4.91937 15.2779 4.76536 15.2779M4.76536 15.2779C4.61135 15.2779 4.47274 15.2163 4.36493 15.1085L1.99316 12.6135M4.76536 15.2779V0.87793M8.46191 3.54231L10.8029 1.09354L10.8491 1.04734C10.9415 0.939534 11.0801 0.87793 11.2341 0.87793M11.2341 0.87793C11.3881 0.87793 11.5267 0.939534 11.6345 1.04734L14.0063 3.54231M11.2341 0.87793V15.2779" stroke="#171717" stroke-width="1.5" stroke-miterlimit="10" stroke-linecap="round" stroke-linejoin="round" />
              </svg>
              Сортувати за: {{ selectedSortBy }}
              <svg width="9" height="6" viewBox="0 0 9 6" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M9.00525 1.41344C9.00525 1.60444 8.93225 1.79644 8.78625 1.94244L5.31625 5.42944C5.17525 5.57044 4.98425 5.64944 4.78425 5.64944C4.58525 5.64944 4.39425 5.57044 4.25325 5.42944L0.781251 1.94244C0.489251 1.64944 0.489251 1.17544 0.783251 0.882439C1.07725 0.590439 1.55225 0.591439 1.84425 0.884439L4.78425 3.83744L7.72425 0.884439C8.01625 0.591439 8.49025 0.590439 8.78425 0.882439C8.93225 1.02844 9.00525 1.22144 9.00525 1.41344Z" fill="#171717" />
              </svg>
            </button>
            <div class="dropdown-menu custom-dropdown" [class.show]="dropdowns['sortfilters']" aria-labelledby="sortByDropdown">
              <a class="dropdown-item" href="javascript:void(0)" (click)="selectedSortBy = 'Датою'; sortData()">Датою</a>
              <a class="dropdown-item" href="javascript:void(0)" (click)="selectedSortBy = 'Судом'; sortData()">Судом</a>
              <a class="dropdown-item" href="javascript:void(0)" (click)="selectedSortBy = 'Суддею'; sortData()">Суддею</a>
            </div>
          </div>
          <span class="me-2" (click)="toggleSortDirection()">
            <i class="fa-solid fa-arrow-down-short-wide" *ngIf="!ascendingSort" [style.font-size.px]="24" class="me-2"></i>
            <i class="fa-solid fa-arrow-up-wide-short" *ngIf="ascendingSort" [style.font-size.px]="24" class="me-2"></i>
          </span>
          <i *ngIf="currentView === 'list'" class="fas fa-file-download fa-2x" (click)="exportDataToExcel()" title="Зберегти"></i>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="currentView === 'cards'">
    <div class="row" #cardRow>
      <ng-container *ngFor="let miniCourtCard of courtDataList">
        <div class="col-md-4">
          <app-mini-court-card [miniCourtData]="miniCourtCard" [caseNumberIds]="caseNumberIds" [id]="id" (openModal)="openModal($event)"></app-mini-court-card>
        </div>
      </ng-container>
    </div>
  </div>

  <div *ngIf="currentView === 'list'" class="table-responsive">
    <table class="table styled-table">
      <thead>
        <tr>
          <th>Номер справи</th>
          <th>Суд</th>
          <th>Судді</th>
          <th>Позивач</th>
          <th>Відповідач</th>
          <th>Предмет позову</th>
          <th>Дата останньої події</th>
        </tr>
      </thead>
      <tbody>
        <ng-container *ngFor="let miniCourtData of courtDataList; let i = index">
          <tr>
            <td [class]="i % 2 === 0 ? 'even-row' : 'odd-row'">
              <a class="btn-link" (click)="openModal(miniCourtData)">
                {{ miniCourtData.caseNumber }}
              </a>
            </td>
            <td [class]="i % 2 === 0 ? 'even-row' : 'odd-row'">{{ miniCourtData.courtName }}</td>
            <td [class]="i % 2 === 0 ? 'even-row' : 'odd-row'">{{ miniCourtData.judge }}</td>
            <td [class]="i % 2 === 0 ? 'even-row' : 'odd-row'">
              <ng-container *ngFor="let plaintiff of miniCourtData.plaintiff">
                <a *ngIf="plaintiff.NAME" class="link">Назва: {{ plaintiff.NAME }}<br></a>
                <ng-container *ngIf="plaintiff.TYPE">
                  <a class="link">Тип: {{ plaintiff.TYPE }}<br></a>
                </ng-container>
                <ng-container *ngIf="plaintiff.EDRPOU">
                  <a class="link">Код: {{ plaintiff.EDRPOU }}<br></a>
                </ng-container>
              </ng-container>
            </td>
            <td [class]="i % 2 === 0 ? 'even-row' : 'odd-row'">
              <ng-container *ngIf="miniCourtData.defendant && miniCourtData.defendant.length">
                <div *ngFor="let defendant of miniCourtData.defendant">
                  <a *ngIf="defendant.NAME" class="link">Назва: {{ defendant.NAME }}<br></a>
                  <ng-container *ngIf="defendant.TYPE">
                    <a class="link">Тип: {{ defendant.TYPE }}<br></a>
                  </ng-container>
                  <ng-container *ngIf="defendant.EDRPOU">
                    <a class="link">Код: {{ defendant.EDRPOU }}<br></a>
                  </ng-container>
                </div>
              </ng-container>
            </td>
            <td [class]="i % 2 === 0 ? 'even-row' : 'odd-row'">{{ miniCourtData.description }}</td>
            <td [class]="i % 2 === 0 ? 'even-row' : 'odd-row'">{{ miniCourtData.lastDate }}</td>
          </tr>
        </ng-container>
      </tbody>
    </table>
  </div>
</div>

<div *ngIf="activeTab === 'instances'">
  <app-executive-proceedings></app-executive-proceedings>
</div>

